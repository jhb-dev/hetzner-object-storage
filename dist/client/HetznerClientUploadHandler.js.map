{"version":3,"sources":["../../src/client/HetznerClientUploadHandler.ts"],"sourcesContent":["'use client'\nimport type { FC } from 'react'\nimport { createClientUploadHandler } from '@payloadcms/plugin-cloud-storage/client'\n\n// Explicitly type the handler\nexport const HetznerClientUploadHandler: FC<any> = createClientUploadHandler({\n  handler: async ({ apiRoute, collectionSlug, file, prefix, serverHandlerPath, serverURL }) => {\n    // Request a signed URL from the server\n    const response = await fetch(`${serverURL}${apiRoute}${serverHandlerPath}`, {\n      body: JSON.stringify({\n        collectionSlug,\n        filename: file.name,\n        mimeType: file.type,\n      }),\n      credentials: 'include',\n      method: 'POST',\n    })\n\n    if (!response.ok) {\n      throw new Error(`Failed to get signed URL: ${response.status} ${response.statusText}`)\n    }\n\n    const { url } = await response.json()\n\n    // Upload the file directly to Hetzner using the signed URL\n    const uploadResponse = await fetch(url, {\n      body: file,\n      headers: { 'Content-Length': file.size.toString(), 'Content-Type': file.type },\n      method: 'PUT',\n    })\n\n    if (!uploadResponse.ok) {\n      throw new Error(\n        `Failed to upload file: ${uploadResponse.status} ${uploadResponse.statusText}`,\n      )\n    }\n\n    // Return the prefix if provided\n    return { prefix }\n  },\n})\n"],"names":["createClientUploadHandler","HetznerClientUploadHandler","handler","apiRoute","collectionSlug","file","prefix","serverHandlerPath","serverURL","response","fetch","body","JSON","stringify","filename","name","mimeType","type","credentials","method","ok","Error","status","statusText","url","json","uploadResponse","headers","size","toString"],"mappings":"AAAA;AAEA,SAASA,yBAAyB,QAAQ,0CAAyC;AAEnF,8BAA8B;AAC9B,OAAO,MAAMC,6BAAsCD,0BAA0B;IAC3EE,SAAS,OAAO,EAAEC,QAAQ,EAAEC,cAAc,EAAEC,IAAI,EAAEC,MAAM,EAAEC,iBAAiB,EAAEC,SAAS,EAAE;QACtF,uCAAuC;QACvC,MAAMC,WAAW,MAAMC,MAAM,GAAGF,YAAYL,WAAWI,mBAAmB,EAAE;YAC1EI,MAAMC,KAAKC,SAAS,CAAC;gBACnBT;gBACAU,UAAUT,KAAKU,IAAI;gBACnBC,UAAUX,KAAKY,IAAI;YACrB;YACAC,aAAa;YACbC,QAAQ;QACV;QAEA,IAAI,CAACV,SAASW,EAAE,EAAE;YAChB,MAAM,IAAIC,MAAM,CAAC,0BAA0B,EAAEZ,SAASa,MAAM,CAAC,CAAC,EAAEb,SAASc,UAAU,EAAE;QACvF;QAEA,MAAM,EAAEC,GAAG,EAAE,GAAG,MAAMf,SAASgB,IAAI;QAEnC,2DAA2D;QAC3D,MAAMC,iBAAiB,MAAMhB,MAAMc,KAAK;YACtCb,MAAMN;YACNsB,SAAS;gBAAE,kBAAkBtB,KAAKuB,IAAI,CAACC,QAAQ;gBAAI,gBAAgBxB,KAAKY,IAAI;YAAC;YAC7EE,QAAQ;QACV;QAEA,IAAI,CAACO,eAAeN,EAAE,EAAE;YACtB,MAAM,IAAIC,MACR,CAAC,uBAAuB,EAAEK,eAAeJ,MAAM,CAAC,CAAC,EAAEI,eAAeH,UAAU,EAAE;QAElF;QAEA,gCAAgC;QAChC,OAAO;YAAEjB;QAAO;IAClB;AACF,GAAE"}